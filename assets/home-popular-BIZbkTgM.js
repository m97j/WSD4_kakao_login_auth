import{a as O}from"./axios-upsvKRUO.js";import{u as A}from"./wishlist-CedwucIA.js";import{_ as G,r as v,d as T,e as N,m as J,w as K,o as a,c as l,a as c,F as z,f as B,p as M,t as y,b,q as Q,l as X,s as Y,u as Z,v as $,x as p,j as L,y as S,i as V}from"./index-BWbI39gf.js";import"./URL-D3v2b3Gp.js";import{M as ee}from"./MovieInfiniteScroll-DCTI-JFI.js";const te={name:"MovieGrid",props:{fetchUrl:{type:String,required:!0}},setup(w){const s=v([]),t=v(1),e=v(null),d=v(4),n=v(20),o=v(window.innerWidth<=768);v("grid");let h=null;const{wishlist:u,loadWishlist:k,toggleWishlist:I,isInWishlist:E}=A(),R=async()=>{try{const f=Math.ceil(6);let g=[];for(let r=1;r<=f;r++){const m=await O.get(w.fetchUrl,{params:{page:r,per_page:n}});g=[...g,...m.data.results]}s.value=g.slice(0,120)}catch(i){console.error("Error fetching movies:",i)}},F=i=>`https://image.tmdb.org/t/p/w300${i}`,W=()=>{if(e.value){const i=e.value.offsetWidth,f=window.innerHeight-e.value.offsetTop,g=o.value?90:200,r=o.value?150:220,m=o.value?10:15,P=-10;d.value=Math.floor(i/(g+m));const _=Math.floor(f/(r+P));n.value=d.value*_}},H=T(()=>{const i=(t.value-1)*n.value,f=i+n.value;return s.value.slice(i,f).reduce((r,m,P)=>{const _=Math.floor(P/d.value);return r[_]||(r[_]=[]),r[_].push(m),r},[])}),x=T(()=>Math.ceil(s.value.length/n.value)),q=()=>{t.value<x.value&&t.value++},D=()=>{t.value>1&&t.value--},U=()=>{o.value=window.innerWidth<=768,W()},j=i=>{C(),h=setTimeout(()=>{I(i)},2e3)},C=()=>{h&&(clearTimeout(h),h=null)};return N(()=>{R(),W(),k(),window.addEventListener("resize",U)}),J(()=>{window.removeEventListener("resize",U)}),K([d,n],()=>{t.value=1}),{visibleMovieGroups:H,currentPage:t,totalPages:x,getImageUrl:F,nextPage:q,prevPage:D,gridContainer:e,rowSize:d,startWishlistTimer:j,clearWishlistTimer:C,toggleWishlist:I,isInWishlist:E}}},oe={class:"movie-grid",ref:"gridContainer"},se=["onMouseup"],ae=["src","alt"],ie={class:"movie-title"},ne={key:0,class:"wishlist-indicator"},re={key:0,class:"pagination"},le=["disabled"],ce=["disabled"];function de(w,s,t,e,d,n){return a(),l("div",oe,[c("div",{class:M(["grid-container",w.currentView])},[(a(!0),l(z,null,B(e.visibleMovieGroups,(o,h)=>(a(),l("div",{key:h,class:M(["movie-row",{full:o.length===e.rowSize}])},[(a(!0),l(z,null,B(o,u=>(a(),l("div",{key:u.id,class:"movie-card",onMouseup:k=>e.toggleWishlist(u)},[c("img",{src:e.getImageUrl(u.poster_path),alt:u.title},null,8,ae),c("div",ie,y(u.title),1),e.isInWishlist(u.id)?(a(),l("div",ne,"👍")):b("",!0)],40,se))),128))],2))),128))],2),e.totalPages>1?(a(),l("div",re,[c("button",{onClick:s[0]||(s[0]=(...o)=>e.prevPage&&e.prevPage(...o)),disabled:e.currentPage===1},"< 이전",8,le),c("span",null,y(e.currentPage)+" / "+y(e.totalPages),1),c("button",{onClick:s[1]||(s[1]=(...o)=>e.nextPage&&e.nextPage(...o)),disabled:e.currentPage===e.totalPages},"다음 >",8,ce)])):b("",!0)],512)}const ue=G(te,[["render",de],["__scopeId","data-v-acab3a9b"]]),ve={class:"popular-container"},he={key:0},ge={class:"view-toggle"},fe={key:1},me=Q({__name:"home-popular",setup(w){X.add(Y,Z),console.error("TMDB API 키가 설정되지 않았습니다. .env 파일을 확인하세요.");const s="";console.error("유효한 fetchURL이 생성되지 않았습니다. API 키를 확인하세요.");const t=v("grid"),e=()=>{t.value="grid",n()},d=()=>{t.value="list",o()},n=()=>{document.body.style.overflow="hidden"},o=()=>{document.body.style.overflow="auto"};return N(()=>{n()}),$(()=>{o()}),(h,u)=>(a(),l("div",ve,[p(s)?(a(),l("div",he,[c("div",ge,[c("button",{onClick:e,class:M({active:t.value==="grid"})},[L(p(V),{icon:["fas","th"]})],2),c("button",{onClick:d,class:M({active:t.value==="list"})},[L(p(V),{icon:["fas","bars"]})],2)]),t.value==="grid"?(a(),S(ue,{key:0,title:"인기 영화",fetchUrl:p(s)},null,8,["fetchUrl"])):b("",!0),t.value==="list"?(a(),S(ee,{key:1,title:"인기 영화",fetchUrl:p(s)},null,8,["fetchUrl"])):b("",!0)])):(a(),l("p",fe,"영화를 불러오는 중입니다. 잠시만 기다려주세요..."))]))}}),Pe=G(me,[["__scopeId","data-v-7330e24c"]]);export{Pe as default};
